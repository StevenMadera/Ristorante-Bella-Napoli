<!DOCTYPE html>
<html lang="es">
<head>
  
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ristorante Bella Napoli - Reservas</title>
  <style>
    :root {
      --primary: #8B0000; /* Rojo oscuro italiano */
      --secondary: #F5DEB3; /* Beige como mantel */
      --success: #228B22; /* Verde hierba */
      --danger: #B22222; /* Rojo fuego */
      --warning: #FFD700; /* Dorado */
      --info: #4682B4; /* Azul mediterráneo */
    }
    
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #FFF8DC;
      color: #333;
      background-image: url('italian-pattern.png');
      background-attachment: fixed;
    }
    body.dark-mode {
      background-color: #333;
      color: #fff;
      background-image: url('italian-pattern-dark.png');}
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    header {
      background-color: var(--primary);
      color: white;
      padding: 30px 0;
      text-align: center;
      margin-bottom: 30px;
      border-bottom: 5px solid var(--warning);
      background-image: linear-gradient(to right, var(--primary), #A52A2A);
    }
    
    .restaurant-name {
      font-size: clamp(2rem, 5vw, 3rem);
      font-family: 'Playfair Display', serif;
    }
    
    .slogan {
      font-size: 1.2rem;
      margin: 10px 0 0;
      font-weight: 300;
    }
    
    .dashboard {
      display: grid;
      grid-template-columns: 1fr;
      gap: 30px;
    }
    
    @media (min-width: 992px) {
      .dashboard {
        grid-template-columns: 2fr 1fr;
      }
    }
    
    .reservation-card {
      background: white;
      border-radius: 8px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      border: 1px solid var(--secondary);
      background-color: rgba(255, 255, 255, 0.95);
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--primary);
    }
    
    input, select, textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-family: inherit;
      font-size: 16px;
      transition: border 0.3s;
    }
    
    input:focus, select:focus, textarea:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 0 2px rgba(139, 0, 0, 0.2);
    }
    
    .tables-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    
    .table {
      aspect-ratio: 1;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: bold;
      color: white;
      position: relative;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }
    
    .table:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 18px rgba(0,0,0,0.2);
      background-color: var(--info);
    }
    
    .table::after {
      content: attr(data-capacity);
      position: absolute;
      bottom: -20px;
      left: 50%;
      transform: translateX(-50%);
      color: #333;
      font-size: 0.8rem;
    }
    
    .available {
      background-color: var(--success);
    }
    
    .occupied {
      background-color: var(--danger);
      cursor: not-allowed;
    }
    
    .selected {
      background-color: var(--warning);
      color: #333;
    }
    
    .reserved-by-you {
      background-color: var(--info);
    }
    
    .legend {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 25px 0;
      flex-wrap: wrap;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .legend-color {
      width: 20px;
      height: 20px;
      border-radius: 50%;
    }
    
    .summary-card {
      background: white;
      border-radius: 8px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      border: 1px solid var(--secondary);
      background-color: rgba(255, 255, 255, 0.95);
    }
    
    .reservations-list {
      margin-top: 20px;
    }
    
    .reservation-item {
      padding: 15px;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background-color 0.2s;
    }
    
    .reservation-item:hover {
      background-color: #f9f9f9;
    }
    
    .reservation-details {
      flex: 1;
    }
    
    .reservation-actions {
      display: flex;
      gap: 10px;
    }
    
    button {
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s;
      font-family: 'Playfair Display', serif;
    }
    
    button:hover {
      background-color: #6B0000;
      transform: translateY(-2px);
    }
    
    button:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
      transform: none;
    }
    
    .btn-secondary {
      background-color: var(--secondary);
      color: #333;
    }
    
    .btn-secondary:hover {
      background-color: #E6D5A8;
    }
    
    .btn-small {
      padding: 6px 12px;
      font-size: 14px;
    }
    
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .restaurant-image {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 20px;
      border: 3px solid var(--secondary);
    }
    
    .section-title {
      transition: all 0.3s ease-in-out;
      color: var(--primary);
      border-bottom: 2px solid var(--warning);
      padding-bottom: 10px;
      margin-top: 30px;
    }
    .section-title:hover {
      color: var(--info);
      transform: translateY(-3px);
    }
    .requests {
      font-style: italic;
      color: var(--info);
      margin-top: 5px;
    }
    
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 25px;
      background-color: var(--success);
      color: white;
      border-radius: 4px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      transform: translateX(200%);
      transition: transform 0.3s ease-out;
      z-index: 1000;
    }
    
    .notification.show {
      transform: translateX(0);
    }
    
    @media (max-width: 576px) {
  .form-group label, .form-group input, .form-group select, .form-group textarea {
    font-size: 14px;
  }
  .table {
    font-size: 14px;
  }
}
    
    @media (max-width: 768px) {
      .dashboard {
        grid-template-columns: 1fr;
      }
      .reservation-card, .summary-card {
        margin-bottom: 20px;
      }
    }
    
    @media (max-width: 992px) {
      .tables-grid {
        grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
      }
    }

.table.selected {
  border: 3px solid var(--warning);
  position: relative;
}

.table.selected::before {
  content: '✓';
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 1.5rem;
  color: var(--warning);
}
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <div class="container">
      <h1 class="restaurant-name">Ristorante Bella Napoli</h1>
      <p class="slogan">Auténtica cocina italiana desde 1985</p>
    </div>
  </header>
  
  <main class="container">
    <div class="dashboard">
      <div class="reservation-card">
        <img src="63def53f34825.jpeg"" alt="Interior del restaurante" class="restaurant-image">
        <h2 class="section-title">Reserva tu mesa</h2>
        
        <form id="reservationForm">
          <div class="form-group">
            <label for="name">Nombre completo</label>
            <input type="text" id="name" required>
          </div>
          
          <div class="form-group">
            <label for="email">Correo electrónico</label>
            <input type="email" id="email" required>
          </div>
          
          <div class="form-group">
            <label for="phone">Teléfono</label>
            <input type="tel" id="phone" required>
          </div>
          
          <div class="form-group">
            <label for="date">Fecha</label>
            <input type="date" id="date" required>
          </div>
          
          <div class="form-group">
            <label for="time">Hora</label>
            <select id="time" required>
              <option value="">Seleccione una hora</option>
              <option value="12:00">12:00 PM</option>
              <option value="12:30">12:30 PM</option>
              <option value="13:00">1:00 PM</option>
              <!-- Más horas... -->
              <option value="20:00">8:00 PM</option>
              <option value="20:30">8:30 PM</option>
              <option value="21:00">9:00 PM</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="guests">Número de comensales</label>
            <select id="guests" required>
              <option value="">Seleccione cantidad</option>
              <option value="1">1 persona</option>
              <option value="2">2 personas</option>
              <option value="3">3 personas</option>
              <option value="4">4 personas</option>
              <option value="5">5 personas</option>
              <option value="6">6 personas</option>
              <option value="7">7 personas</option>
              <option value="8">8 personas</option>
              <option value="9">9+ personas (grupos)</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="specialRequests">Peticiones especiales</label>
            <textarea id="specialRequests" rows="3" placeholder="Alergias, preferencias, celebraciones especiales..."></textarea>
          </div>
          
          <h3 class="section-title">Selecciona tu mesa</h3>
          <p>Disponibilidad para <span id="selectedDate">hoy</span> a las <span id="selectedTime">--:--</span></p>
          
          <div class="legend">
            <div class="legend-item">
              <div class="legend-color available"></div>
              <span>Disponible</span>
            </div>
            <div class="legend-item">
              <div class="legend-color occupied"></div>
              <span>Ocupada</span>
            </div>
            <div class="legend-item">
              <div class="legend-color selected"></div>
              <span>Seleccionada</span>
            </div>
            <div class="legend-item">
              <div class="legend-color reserved-by-you"></div>
              <span>Tu reserva</span>
            </div>
          </div>
          
          <div class="tables-grid" id="tablesGrid"></div>
          
          <div class="form-group">
            <button type="submit" id="submitBtn">Confirmar Reserva</button>
          </div>
        </form>
      </div>
      
      <div class="summary-card">
        <h2 class="section-title">Tus Reservas</h2>
        <div class="reservations-list" id="reservationsList">
          <p>Cargando tus reservas...</p>
        </div>
        
        <h2 class="section-title">Horario</h2>
        <p><strong>Lunes a Jueves:</strong> 12:00 PM - 10:00 PM</p>
        <p><strong>Viernes y Sábado:</strong> 12:00 PM - 11:00 PM</p>
        <p><strong>Domingo:</strong> 12:00 PM - 9:00 PM</p>
        
        <h2 class="section-title">Contacto</h2>
        <p><strong>Teléfono:</strong> +34 123 456 789</p>
        <p><strong>Email:</strong> info@bellanapoli.com</p>
        <p><strong>Dirección:</strong> Calle Italia, 123, Barcelona</p>
      </div>
    </div>
  </main>
  
  <div class="notification" id="notification"></div>

  <script>
    // Datos iniciales
    const tables = [
      { id: 1, capacity: 2, location: 'Terraza' },
      { id: 2, capacity: 2, location: 'Interior' },
      { id: 3, capacity: 4, location: 'Interior' },
      { id: 4, capacity: 4, location: 'Terraza' },
      { id: 5, capacity: 6, location: 'Interior' },
      { id: 6, capacity: 6, location: 'Terraza' },
      { id: 7, capacity: 8, location: 'Interior' },
      { id: 8, capacity: 2, location: 'Barra' },
      { id: 9, capacity: 2, location: 'Barra' },
      { id: 10, capacity: 4, location: 'Interior' },
      { id: 11, capacity: 4, location: 'Terraza' },
      { id: 12, capacity: 6, location: 'Interior' }
    ];
    
    // Estado de la aplicación
    let selectedTables = [];
    let userReservations = [];
    let userId = localStorage.getItem('userId') || `user_${Math.random().toString(36).substr(2, 9)}`;
    
    // Elementos del DOM
    const tablesGrid = document.getElementById('tablesGrid');
    const reservationsList = document.getElementById('reservationsList');
    const reservationForm = document.getElementById('reservationForm');
    const submitBtn = document.getElementById('submitBtn');
    const dateInput = document.getElementById('date');
    const timeInput = document.getElementById('time');
    const guestsInput = document.getElementById('guests');
    const selectedDateSpan = document.getElementById('selectedDate');
    const selectedTimeSpan = document.getElementById('selectedTime');
    const notification = document.getElementById('notification');
    
    // Inicializar fecha mínima (hoy)
    dateInput.min = new Date().toISOString().split('T')[0];
    
    // Cargar reservas al iniciar
    document.addEventListener('DOMContentLoaded', () => {
      if (!localStorage.getItem('userId')) {
        localStorage.setItem('userId', userId);
      }
      
      // Configurar fecha por defecto (hoy)
      const today = new Date().toISOString().split('T')[0];
      dateInput.value = today;
      updateSelectedDateTime();
      
      // Cargar mesas y reservas
      renderTables();
      fetchUserReservations();
      
      // Event listeners
      dateInput.addEventListener('change', updateTablesAvailability);
      timeInput.addEventListener('change', updateTablesAvailability);
      guestsInput.addEventListener('change', filterTablesByCapacity);
      
      reservationForm.addEventListener('submit', handleReservationSubmit);
    });
    
    function updateSelectedDateTime() {
      const date = new Date(dateInput.value);
      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      selectedDateSpan.textContent = date.toLocaleDateString('es-ES', options);
      selectedTimeSpan.textContent = timeInput.value || '--:--';
    }
    
    function renderTables() {
      tablesGrid.innerHTML = '';
      
      tables.forEach(table => {
        const tableElement = document.createElement('div');
        tableElement.className = 'table available';
        tableElement.textContent = table.id;
        tableElement.dataset.id = table.id;
        tableElement.dataset.capacity = table.capacity;
        tableElement.title = `Mesa ${table.id} (${table.capacity} personas) - ${table.location}`;
        
        tableElement.addEventListener('click', () => selectTable(table.id, tableElement));
        
        tablesGrid.appendChild(tableElement);
      });
    }
    
    function selectTable(tableId, element) {
  if (selectedTables.includes(tableId)) {
    selectedTables = selectedTables.filter(id => id !== tableId);
    element.classList.remove('selected');
  } else {
    selectedTables.push(tableId);
    element.classList.add('selected');
  }
}

    async function updateTablesAvailability() {
      updateSelectedDateTime();

      const date = dateInput.value;
      const time = timeInput.value;

      if (!date || !time) return;

      try {
        const occupiedTables = simulateOccupiedTables(date, time);

        document.querySelectorAll('.table').forEach(tableElement => {
          const tableId = parseInt(tableElement.dataset.id);

          tableElement.classList.remove('occupied', 'reserved-by-you', 'available', 'selected');

          if (occupiedTables.includes(tableId)) {
            tableElement.classList.add('occupied');
            tableElement.onclick = null;
          } else if (userReservations.some(r => r.tableIds.includes(tableId) && r.date === date && r.time === time)) {
            tableElement.classList.add('reserved-by-you');
            tableElement.onclick = null;
          } else {
            tableElement.classList.add('available');
            tableElement.onclick = () => selectTable(tableId, tableElement);
          }
        });
      } catch (error) {
        console.error('Error al actualizar disponibilidad:', error);
        showNotification('Error al cargar disponibilidad', 'danger');
      }
    }
    
    function filterTablesByCapacity() {
      const guests = parseInt(guestsInput.value) || 0;
      
      document.querySelectorAll('.table').forEach(tableElement => {
        const capacity = parseInt(tableElement.dataset.capacity);
        
        if (guests === 0) {
          tableElement.style.display = 'flex';
        } else if (guests === 9) { // Para grupos grandes
          tableElement.style.display = capacity >= 6 ? 'flex' : 'none';
        } else {
          tableElement.style.display = capacity >= guests ? 'flex' : 'none';
        }
      });
    }
    
    async function fetchUserReservations() {
      try {
        // En una aplicación real, haríamos una llamada al backend
        // const response = await fetch(`/api/reservations?userId=${userId}`);
        // userReservations = await response.json();
        
        // Simulamos respuesta del servidor
        userReservations = simulateUserReservations(userId);
        renderReservations();
      } catch (error) {
        console.error('Error al cargar reservas:', error);
        // Fallback a localStorage
        const localReservations = JSON.parse(localStorage.getItem(`reservations_${userId}`)) || [];
        userReservations = localReservations;
        renderReservations();
      }
    }
    
    function renderReservations() {
      if (userReservations.length === 0) {
        reservationsList.innerHTML = '<p>No tienes reservas activas.</p>';
        return;
      }
      
      reservationsList.innerHTML = userReservations.map(reservation => `
        <div class="reservation-item">
          <div class="reservation-details">
            <strong>Mesa ${reservation.tableId}</strong> (${reservation.guests} personas)
            <div>${formatReservationDate(reservation.date)} a las ${reservation.time}</div>
            ${reservation.specialRequests ? `<div class="requests">${reservation.specialRequests}</div>` : ''}
          </div>
          <div class="reservation-actions">
            <button class="btn-secondary btn-small" onclick="cancelReservation('${reservation.id}')">Cancelar</button>
          </div>
        </div>
      `).join('');
    }
    
    function formatReservationDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('es-ES', { weekday: 'short', day: 'numeric', month: 'short' });
    }
    
    async function handleReservationSubmit(e) {
      e.preventDefault();

      if (selectedTables.length === 0) {
        showNotification('Por favor, selecciona al menos una mesa', 'danger');
        return;
      }

      const reservationData = {
        userId,
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        date: dateInput.value,
        time: timeInput.value,
        guests: guestsInput.value,
        tableIds: selectedTables, // Cambiado para soportar múltiples mesas
        specialRequests: document.getElementById('specialRequests').value
      };

      submitBtn.disabled = true;
      submitBtn.innerHTML = '<span class="loading"></span> Procesando...';

      try {
        // Simula la creación de la reserva
        const newReservation = simulateCreateReservation(reservationData);
        userReservations.push(newReservation);

        // Actualiza la UI
        renderReservations();
        updateTablesAvailability();
        selectedTables = []; // Limpia las mesas seleccionadas

        // Muestra confirmación
        showNotification(`Reserva confirmada para las mesas ${newReservation.tableIds.join(', ')}`, 'success');

        // Resetea el formulario
        reservationForm.reset();
        updateSelectedDateTime();
      } catch (error) {
        console.error('Error al crear reserva:', error);
        showNotification('Error al procesar la reserva', 'danger');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Confirmar Reserva';
      }
    }
    
    function cancelReservation(reservationId) {
      if (!confirm('¿Estás seguro de que deseas cancelar esta reserva?')) return;
      
      try {
        // En una aplicación real, haríamos DELETE al backend
        // await fetch(`/api/reservations/${reservationId}`, { method: 'DELETE' });
        
        // Simulamos cancelación
        userReservations = userReservations.filter(r => r.id !== reservationId);
        renderReservations();
        updateTablesAvailability();
        
        showNotification('Reserva cancelada', 'info');
      } catch (error) {
        console.error('Error al cancelar reserva:', error);
        showNotification('Error al cancelar la reserva', 'danger');
      }
    }
    
    function showNotification(message, type) {
      notification.textContent = message;
      notification.className = 'notification show';
      notification.style.backgroundColor = getNotificationColor(type);
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 3000);
    }
    
    function getNotificationColor(type) {
      const colors = {
        success: '#228B22',
        danger: '#B22222',
        info: '#4682B4',
        warning: '#FFD700'
      };
      return colors[type] || '#4682B4';
    }
    
    // Funciones de simulación para cuando no hay backend
    function simulateOccupiedTables(date, time) {
      // Simula que algunas mesas están ocupadas
      const randomOccupied = [];
      const totalTables = tables.length;
      
      // 30% de probabilidad de que una mesa esté ocupada
      tables.forEach(table => {
        if (Math.random() < 0.3) {
          randomOccupied.push(table.id);
        }
      });
      
      // Mesas ocupadas por este usuario
      const userOccupied = userReservations
        .filter(r => r.date === date && r.time === time)
        .map(r => r.tableId);
      
      return [...new Set([...randomOccupied, ...userOccupied])];
    }
    
    function simulateUserReservations(userId) {
      const today = new Date();
      const reservations = [];
      
      // Crear algunas reservas de ejemplo
      for (let i = 0; i < 3; i++) {
        const date = new Date();
        date.setDate(today.getDate() + i);
        
        reservations.push({
          id: `res_${userId}_${i}`,
          userId,
          tableId: Math.floor(Math.random() * tables.length) + 1,
          date: date.toISOString().split('T')[0],
          time: `${18 + i}:00`,
          guests: Math.floor(Math.random() * 4) + 2,
          name: 'Cliente Ejemplo',
          email: 'ejemplo@email.com',
          phone: '600123456',
          specialRequests: i === 1 ? 'Celebramos un aniversario' : ''
        });
      }
      
      // Guardar en localStorage para persistencia
      localStorage.setItem(`reservations_${userId}`, JSON.stringify(reservations));
      
      return reservations;
    }
    
    function simulateCreateReservation(reservationData) {
      const newReservation = {
        id: `res_${userId}_${Date.now()}`,
        ...reservationData
      };
      
      // Actualizar localStorage
      const currentReservations = JSON.parse(localStorage.getItem(`reservations_${userId}`)) || [];
      currentReservations.push(newReservation);
      localStorage.setItem(`reservations_${userId}`, JSON.stringify(currentReservations));
      
      return newReservation;
    }
    
    // Hacer funciones accesibles globalmente para los botones
    window.cancelReservation = cancelReservation;
  </script>
  <footer style="background-color: var(--primary); color: white; padding: 20px 0; text-align: center; margin-top: 40px;">
    <p>&copy; 2025 Ristorante Bella Napoli | Diseñado con amor a la cocina italiana.</p>
  </footer>
</body>
</html>